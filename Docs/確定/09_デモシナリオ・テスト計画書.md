# 09_デモシナリオ・テスト計画書.md

## 1. デモ動画シナリオ (Target: 2-3 mins)

### ストーリーボード (タイムライン)

```mermaid
gantt
    title デモ動画タイムライン
    dateFormat mm:ss
    axisFormat %M:%S
    
    section Scene 1: Intro
    日常モード表示        :a1, 00:00, 15s
    目的地設定           :a2, after a1, 10s
    安全スキャン表示      :a3, after a2, 5s
    
    section Scene 2: Crisis
    気象警報発生          :b1, 00:30, 10s
    自動モード切替        :b2, after b1, 10s
    Thinking Log表示     :b3, after b2, 10s
    
    section Scene 3: Avoidance
    危険ルート表示        :c1, 01:00, 15s
    自律リトライ動作      :c2, after c1, 20s
    新ルート確定         :c3, after c2, 10s
    
    section Scene 4: Conclusion
    AIナレーション       :d1, 01:45, 10s
    ロゴ・エンディング    :d2, after d1, 5s
```

### Scene 1: Intro (0:00 - 0:30)

```mermaid
flowchart LR
    A["🌙 夜間・日常モード"] --> B["📍 渋谷駅前"]
    B --> C["🏠 自宅を目的地に設定"]
    C --> D["✨ 安全スキャン開始"]
    D --> E["AI: 明るい道を案内します"]
```

- **Visual**: 日常モード（青）。渋谷駅前の明るい地図。
- **Action**: 「駅から自宅へ」をセット。
- **AI Voice**: 「お疲れ様です。今日は少し遅いので、人通りの多い明るい道を案内しますね。」
- **Highlight**: **Async Safety Scan** で地図上に「✨」がポンポンと表示される様子を見せる。

### Scene 2: The Crisis (0:30 - 1:00)

```mermaid
flowchart LR
    A["🌧️ 大雨警報発令"] --> B["⚠️ 自動アラート表示"]
    B --> C["🔴 自動で非常時モードON"]
    C --> D["📜 Thinking Log高速表示"]
```

- **Visual**: 突然のアラート音。APIから「大雨警報」を検知。
- **Action**: **自動的に**非常時モード（赤）に切り替わる。
- **UI Change**: 画面が一瞬で赤黒くなり、Thinking Logが高速で流れる。
  ```
  > ⚠️ WEATHER ALERT DETECTED: 大雨警報
  > AUTO-SWITCHING TO EMERGENCY MODE
  > RISK ASSESSMENT: FLOOD HAZARD HIGH
  ```

### Scene 3: The Avoidance (1:00 - 1:45)

```mermaid
flowchart TD
    A["🛣️ 最短ルート表示"] --> B{"浸水エリア通過?"}
    B -->|Yes| C["❌ Route A は危険"]
    C --> D["🔄 自律リトライ開始"]
    D --> E["📍 安全Waypoint計算"]
    E --> F["🗺️ 新ルート描画"]
    F --> G["✅ 高台経由ルート確定"]
```

- **Visual**: 当初の最短ルートが「浸水エリア（赤ポリゴン）」を通過しているのが見える。
- **AI Action (Agentic Loop)**:
  - ログ: `> Route A is dangerous. Calculating detour...`
  - 地図上でAIが「代わりの地点（Waypoint）」を探し、線を書き換えるアニメーション。
- **Result**: 危険エリアを大きく迂回する新しいルートが確定。

### Scene 4: Conclusion (1:45 - 2:00)

```mermaid
flowchart LR
    A["🤖 AI Voice"] --> B["生存確率最大化ルートを<br/>設定しました"]
    B --> C["🚶 移動開始"]
    C --> D["🎬 ロゴ表示"]
```

- **AI Voice**: 「生存確率最大化ルートを設定しました。直ちに移動を開始してください。」
- **Outro**: "Situation-Adaptive Safe Routing AI" ロゴ。

## 2. テスト計画

### テストケース一覧

```mermaid
flowchart TD
    subgraph Unit ["ユニットテスト"]
        U1["Route Agent 全ルート不可時<br/>Waypoint生成確認"]
        U2["Vision API タイムアウト時<br/>UIフリーズなし確認"]
        U3["Weather API失敗時<br/>キャッシュ使用確認"]
        U4["気象警報検知時<br/>自動モード切替"]
    end
    
    subgraph Integration ["結合テスト"]
        I1["Flutter → Cloud Run<br/>End-to-End疎通"]
        I2["モード切替時<br/>UI/API連動確認"]
    end
    
    subgraph Field ["フィールドテスト"]
        F1["GPSシミュレーション<br/>渋谷駅周辺移動"]
        F2["Haptic Feedback<br/>触感確認"]
    end
```

### Unit Test
- Route Agentが「全ルート不可」の時に正しくWaypointを生成するか？
- Vision APIがタイムアウトした時にUIがフリーズしないか？
- **気象警報（alerts）を検知した時に自動でモード切替が発動するか？**

### Field Test (Simulation)
- GPSシミュレータ（Android Emulator / iOS Simulator）を使用し、渋谷駅周辺を移動するシミュレーションを行う。
- 実機で「モード切替」の触確（Haptic Feedback）が心地よいか確認。

## 3. デモ撮影チェックリスト

| 項目 | 確認内容 | ✓ |
| :--- | :--- | :---: |
| 画面録画設定 | 60fps, 1080p以上 | ☐ |
| モックデータ準備 | 大雨警報データ（OpenWeatherMap形式） | ☐ |
| BGM/SE | アラート音、モード切替音 | ☐ |
| ナレーション | AI Voiceの音声出力確認 | ☐ |
| Thinking Log速度 | 読める速度に調整済み | ☐ |
| 自動切替演出 | 警報検知→赤画面への遷移がスムーズか | ☐ |
