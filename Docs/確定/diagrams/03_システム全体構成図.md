# ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹æˆå›³

```mermaid
flowchart TB
    subgraph Client["ğŸ“± Mobile Client"]
        iOS["iOS App<br/>SwiftUI"]
        MapsSDK["Google Maps SDK"]
        GPS["Location Manager"]
    end

    subgraph Backend["â˜ï¸ Google Cloud"]
        Functions["Cloud Functions"]
        Genkit["Firebase Genkit"]
        Firestore[("Firestore")]
    end

    subgraph Agents["ğŸ¤– Agentic Workflow"]
        InputAgent["Input Agent"]
        RiskAgent["Risk Evaluator<br/>Gemini 3"]
        RouteAgent["Route Selector"]
        VisionAgent["Visual Analyst<br/>Gemini 3 Vision"]
        Narrator["Narrator Agent"]
    end

    subgraph APIs["ğŸŒ External APIs"]
        WeatherAPI["OpenWeatherMap"]
        HazardAPI["ãƒã‚¶ãƒ¼ãƒ‰ãƒãƒƒãƒ—"]
        PoliceData["è­¦è¦–åºçµ±è¨ˆ"]
        RoutesAPI["Google Routes API"]
        StreetView["Street View API"]
    end

    iOS --> Functions
    Functions --> Genkit
    Genkit --> Firestore
    
    Genkit --> InputAgent
    InputAgent --> RiskAgent
    RiskAgent --> RouteAgent
    RouteAgent --> Narrator
    Genkit --> VisionAgent

    InputAgent --> WeatherAPI
    InputAgent --> HazardAPI
    InputAgent --> PoliceData
    RouteAgent --> RoutesAPI
    VisionAgent --> StreetView
```
